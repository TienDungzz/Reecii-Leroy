{%- doc -%}
  Renders the facet filtering component

  @param {object} results - The search results object
  @param {number} results_size - The number of products in the search results
  @param {object} [filters] - The filters object
{%- enddoc -%}

{%- liquid
  assign bl_stts = block.settings

  case section.settings.product_card_size
    when 'small'
      assign columns_desktop = 5
    when 'medium'
      assign columns_desktop = 4
    when 'large'
      assign columns_desktop = 3
    when 'extra-large'
      assign columns_desktop = 2
    when 'extra-extra-large'
      assign columns_desktop = 1
  endcase

  # Calculate facets margin style
  capture facets_margin_style
    echo '--facets-margin: 0px '
    if bl_stts.filter_style == 'vertical'
      if bl_stts.filter_position == 'left'
        echo bl_stts.facets_margin_right | append: 'px' | append: ' 0px '
      else
        echo '0px 0px '
      endif
    else
      echo ' 0px ' | append: bl_stts.facets_margin_bottom | append: 'px'
    endif
    if bl_stts.filter_style == 'vertical' and bl_stts.filter_position == 'right'
      echo bl_stts.facets_margin_left | append: 'px;'
    else
      echo ' 0px;'
    endif

    echo ' --facets-margin-right: ' | append: bl_stts.facets_margin_right | append: 'px;'
    echo ' --facets-margin-bottom: ' | append: bl_stts.facets_margin_bottom | append: 'px;'
  endcapture

  capture filter_gap_vertical_style
    echo '--filter-gap-vertical: ' | append: bl_stts.filter_gap_vertical | append: 'px;'
  endcapture

  assign enable_grid_view = bl_stts.enable_grid_density
  assign enable_products_per_page = bl_stts.enable_items_per_page
  assign enable_sorting = bl_stts.enable_sorting
  assign filter_type = bl_stts.filter_style
  assign filter_variant_pill = bl_stts.filter_variant_pill
  assign enable_hover_reveal = bl_stts.enable_hover_reveal
  assign heading_label_case = bl_stts.heading_label_case
  assign text_label_case = bl_stts.text_label_case
  assign heading_label_font_size = bl_stts.heading_label_font_size
  assign text_label_font_size = bl_stts.text_label_font_size
  assign enable_divider = bl_stts.enable_divider
  assign divider_color = bl_stts.divider_color
  assign divider_spacing_top = bl_stts.divider_spacing_top
  assign divider_spacing_bottom = bl_stts.divider_spacing_bottom
  assign style = bl_stts.style
  assign filter_swatch = bl_stts.filter_swatch
  assign filter_position = bl_stts.filter_position
  assign filter_label_all = bl_stts.filter_label_all
  assign show_filter_by_tags_sidebar = bl_stts.show_filter_by_tags_sidebar
  assign number_filters = bl_stts.number_filters
  assign enable_count = bl_stts.enable_count
-%}

{{ 'component-facets.css' | asset_url | stylesheet_tag }}
<script src="{{ 'facets.js' | asset_url }}" defer="defer"></script>

<div
  class="
    facets-block-wrapper
    facets-block-wrapper--{{ filter_type }}
    facets-block-wrapper--{{ filter_position }}
    {%- if block.settings.filter_width == 'full-width' %} facets-block-wrapper--full-width{% endif %}
    {% if block.settings.inherit_color_scheme == false %}color-scheme-custom{% endif %}

  "
  style="
    --grid-column--desktop:
      {%- if filter_type == 'horizontal' -%}
        var(--{{ bl_stts.filter_width }})
      {%- else -%}
        {%- if filter_position == 'left' -%}
          2 / var(--facets-vertical-col-width)
        {%- else -%}
          var(--facets-vertical-col-start) / var(--full-width-column-number)
        {%- endif -%}
      {%- endif -%};
    {{ facets_margin_style }}
    {{ filter_gap_vertical_style }}
    --facets-inner-padding-block-start: {{ bl_stts.padding-block-start }}px;
    --facets-inner-padding-block-end: {{ bl_stts.padding-block-end }}px;
    --facets-inner-padding-block: var(--facets-inner-padding-block-start) var(--facets-inner-padding-block-end);
    --facets-inner-padding-inline: var(--padding-md);
    --padding-inline-start: {{ section.settings.padding-inline-start }}px;
    --padding-inline-end: {{ section.settings.padding-inline-end }}px;
    {% if block.settings.inherit_color_scheme == false %}
      {% render 'color-scheme-style', settings: block.settings %}
    {% endif %}
  "
>
  <div
    aria-labelledby="verticalTitle"
    class="
      facets-wrapper
      facets--{{ bl_stts.filter_style }}
      facets--panel-style-{{ style }}
      {% if bl_stts.enable_sticky_filters and filter_type == 'vertical' %} facets--vertical-sticky{% endif %}
      {% unless section.settings.enable_filtering %} facets-wrapper--no-filters{% endunless %}
    "
    id="main-collection-filters"
    data-id="{{ section.id }}"
    style="--font-size--sidebar-heading: {{ heading_label_font_size }};"
  >
    {%- capture sidebar_categories -%}
      {%- content_for 'block', type: '_blog-post-sidebar-category', id: 'static-collection-categories', in_facets: true, heading_label_case: heading_label_case, text_label_case: text_label_case, heading_label_font_size: heading_label_font_size, text_label_font_size: text_label_font_size -%}
    {%- endcapture -%}
    {%- if filter_type == 'vertical' -%}
      {{ sidebar_categories }}
    {%- endif -%}

    {%- capture children -%}
      {% content_for 'blocks' %}
    {%- endcapture -%}

    {% render 'facets',
      bl_stts: bl_stts,
      results: results,
      enable_filtering: bl_stts.enable_filtering,
      enable_sorting: enable_sorting,
      enable_products_per_page: enable_products_per_page,
      enable_grid_view: enable_grid_view,
      filter_type: filter_type,
      filter_variant_pill: filter_variant_pill,
      paginate: paginate,
      enable_hover_reveal: enable_hover_reveal,
      heading_label_case: heading_label_case,
      text_label_case: text_label_case,
      heading_label_font_size: heading_label_font_size,
      text_label_font_size: text_label_font_size,
      style: style,
      limit: limit,
      enable_divider: enable_divider,
      divider_color: divider_color,
      divider_spacing_top: divider_spacing_top,
      divider_spacing_bottom: divider_spacing_bottom,
      filter_swatch: filter_swatch,
      children: children,
      sidebar_categories: sidebar_categories,
      filter_label_all: filter_label_all,
      show_filter_by_tags_sidebar: show_filter_by_tags_sidebar,
      number_filters: number_filters,
      enable_count: enable_count
    %}
  </div>
</div>

{%- if bl_stts.filter_style == 'vertical' -%}
  {%- liquid
    assign sort_by = results.sort_by | default: results.default_sort_by
    assign enable_divider_sorting_vertical = bl_stts.enable_divider_sorting_vertical
    assign selected_sort_by = results.sort_options | where: 'value', sort_by | first
    assign padding_block_start = bl_stts.sorting_vertical_padding_block_start
    assign padding_block_end = bl_stts.sorting_vertical_padding_block_end
  -%}

  <facet-filters-form class="facets facets-vertical-sort facets-vertical-sort--vertical{% if enable_divider_sorting_vertical %} facets-vertical-sort--vertical-divider{% endif %}">
    <form
      class="facets-vertical-form"
      id="FacetSortForm"
      style="--pt: {{ padding_block_start }}px; --pb: {{ padding_block_end }}px;"
    >
      <div class="sorting-wrapper flex items-center gap-lg">
        {%- if enable_grid_view -%}
          {% render 'switcher-grid',
            columns_desktop: columns_desktop,
            filter_type: filter_type,
            style: style,
            enable_hover_reveal: enable_hover_reveal,
            text_label_case: text_label_case
          %}
        {%- endif -%}

        <div class="sorting-wrapper-rightcol flex justify-end gap-lg small-hide medium-hide">
          {%- if enable_products_per_page -%}
            <div class="facet-per-page products-per-page caption">
              {% render 'products-per-page',
                limit: limit,
                style: style,
                enable_hover_reveal: enable_hover_reveal,
                heading_label_case: heading_label_case,
                text_label_case: text_label_case
              %}
            </div>
          {%- endif -%}

          {%- if enable_sorting -%}
            {% render 'facets-sort-by',
              results: results,
              sort_by: sort_by,
              selected_sort_by: selected_sort_by,
              enable_hover_reveal: enable_hover_reveal,
              style: style,
              filter_type: filter_type,
              heading_label_case: heading_label_case,
              text_label_case: text_label_case
            %}
          {%- endif -%}
        </div>
      </div>
    </form>
  </facet-filters-form>
{%- endif -%}

{% stylesheet %}
  .collection-wrapper {
    @media screen and (min-width: 750px) {
      --facets-vertical-col-width: 6;
    }

    @media screen and (min-width: 990px) {
      --facets-vertical-col-width: 2;
    }

    @media screen and (min-width: 1025px) {
      --facets-vertical-col-width: 3;
    }

    &:has(.facets-block-wrapper--right) {
      @media screen and (min-width: 990px) {
        --facets-vertical-col-start: 13;
      }
    }
  }

  .facets-block-wrapper {
    @media screen and (min-width: 750px) {
      margin: var(--facets-margin);
      grid-column: var(--grid-column--desktop);
    }
  }

  .facets-block-wrapper--vertical {
    grid-row: 1 / 4;

    @media screen and (max-width: 1024px) {
      margin: 0;
      grid-column: 6 / 14;

      .facets--vertical > .blog-posts__sidebar-item,
      .facets:not(.facets--drawer) {
        display: none;
      }
    }

    @media screen and (max-width: 749px) {
      grid-column: 7 / 14;
    }

    @media screen and (min-width: 1025px) {
      grid-column: var(--grid-column--desktop);
    }
  }

  .facets-block-wrapper--vertical .facets__disclosure {
    width: fit-content;
  }

  .facets-block-wrapper--vertical .facets__summary {
    margin-bottom: 0;
    padding: var(--padding-sm);
  }

  .facets-block-wrapper--vertical + .facets-toggle {
    @media screen and (max-width: 749px) {
      margin: 0;
    }
  }

  .facets-mobile-wrapper {
    display: flex;
    align-items: center;
    gap: var(--gap-sm);
    justify-content: flex-end;
  }

  .facets-mobile-wrapper:has(> :nth-child(2)) {
    justify-content: space-between;
  }

  dialog-component.facets-block-wrapper:not(:has(.facets--drawer[open])) {
    @media screen and (min-width: 750px) {
      display: none;
    }
  }

  .variant-option__swatch-wrapper {
    position: relative;
    overflow: visible;
    border-radius: var(--options-border-radius);
  }

  .variant-option--swatches-disabled .variant-option__swatch-wrapper {
    overflow: hidden;
  }

  .facets-layout .swatch-item .facet-checkbox {
    padding: 0;
    margin: 0;
  }

  .facets-layout .facets-layout-list--pill .input--primary {
    background-color: rgba(var(--color-foreground-rgb) / 0.05);
  }

  .facets-layout .swatch-item .input--primary:after {
    box-shadow: none;
    border-radius: var(--swatch--border-radius);
  }

  .facets {
    --facets-form-horizontal-gap: 20px;
    --facets-horizontal-max-input-wrapper-height: 230px;
    --facets-upper-z-index: var(--layer-raised);
    --facets-open-z-index: var(--layer-heightened);
    --facets-sticky-z-index: var(--layer-sticky);
    --facets-panel-min-width: 120px;
    --facets-panel-height: 300px;
    --facets-grid-panel-width: 300px;
    --facets-clear-padding: var(--padding-md);
    --facets-clear-shadow: 0 -4px 14px 0 rgb(var(--color-foreground-rgb) / var(--facets-low-opacity));
    --facets-input-label-color: rgb(var(--color-input-text-rgb) / var(--opacity-60));
    --facets-clear-all-min-width: 120px;
    --facets-see-results-min-width: 55%;
    --facets-mobile-gap: 22px;
    --facets-low-opacity: 10%;
    --facets-hover-opacity: 75%;

    top: auto;
    bottom: 0;
    height: var(--drawer-height);
    max-height: var(--drawer-height);
    width: var(--drawer-width);
    max-width: var(--drawer-max-width);
    box-shadow: none;
    padding-block: 0;
    display: block;
    grid-column-start: span 3;

    &:not(.facets--drawer) {
      @media screen and (min-width: 750px) {
        padding-inline: var(--padding-inline-start) var(--padding-inline-end);
        width: 100%;
        max-width: 100%;
      }
    }
  }

  .facets-container {
    display: grid;
    grid-template-columns: repeat(2, auto);
    grid-template-rows: repeat(2, auto);
    padding-top: 1rem;

    .facets--vertical & {
      display: block;
    }
  }

  @media screen and (min-width: 750px) {
    .facets-container > * + * {
      margin-top: 0;
    }
  }

  @media screen and (max-width: 1024px) {
    .facets-container {
      grid-template-columns: 1fr 1fr 1fr;
      column-gap: 2rem;
    }

    .facets {
      grid-column-start: span 1;

      &.facets-vertical-sort {
        grid-column: 2 / 6;

        .switcher-grid ul {
          padding-left: 0;
        }
      }

      .divider {
        display: none;
      }
    }

    .facets--vertical .facets-container {
      grid-template-columns: 1fr;
    }
  }

  @media screen and (max-width: 749px) {
    .facets-container {
      grid-template-columns: 1fr max-content 1fr;
    }

    .facets.facets-vertical-sort {
      grid-column: 1 / 7;
    }
  }

  @media screen and (min-width: 1025px) {
    .facets-vertical-form {
      display: grid;
      align-items: baseline;
      gap: 0 3.5rem;
      grid-template-columns: 1fr max-content max-content;
    }
  }

  .facets-vertical-sort--vertical .facets-vertical-form {
    @media screen and (min-width: 1025px) {
      grid-template-columns: 1fr;
    }

    .sorting-wrapper {
      justify-content: space-between;
    }

    .facets__summary {
      margin-bottom: 0;
      padding: var(--padding-sm);
    }
  }

  @media screen and (min-width: 1025px) {
    .facets-vertical-sort--vertical-divider {
      border-top: var(--style-border-width) solid var(--color-border);
    }
  }

  .collection-wrapper:has(.collection-wrapper--full-width) .facets--vertical:not(.facets--drawer) {
    @media screen and (min-width: 750px) {
      padding-inline-start: max(var(--padding-sm), var(--padding-inline-start));
    }
  }

  .facets--drawer {
    border-radius: 0;
    border-right: var(--style-border-drawer);
    box-shadow: var(--shadow-drawer);
    padding-inline: 0;
  }

  .facets--drawer[open] {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .facets.facets-controls-wrapper {
    @media screen and (min-width: 750px) {
      grid-column: column-1 / column-12;
      color: rgb(var(--color-foreground-rgb) / var(--opacity-70));
      gap: 0 var(--facets-form-horizontal-gap);
      padding-bottom: var(--padding-xs);
    }
  }

  .collection-wrapper:has(.product-grid-mobile--large) .facets-mobile-wrapper.facets-controls-wrapper {
    @media screen and (max-width: 749px) {
      display: none;
    }
  }

  .facets__inputs {
    display: flex;
    flex-direction: column;
    gap: var(--padding-lg);
    width: 100%;
  }

  :is(.facets--drawer, .facets--vertical) .facets__inputs:not(:has(.show-more)) {
    padding-block-end: var(--padding-sm);
  }

  /* Facets - Price */
  .facets__priceblock .facets-price__range {
    padding-block: var(--padding-sm);
  }

  /* Facets - Form */
  .facets__form-wrapper {
    display: flex;
    flex-direction: column;
    color: var(--color-foreground-muted);
    width: 100%;
  }

  .facets__form-vertical .facets__form-wrapper-inner {
    display: flex;
    flex-direction: column;
    gap: var(--filter-gap-vertical);
  }

  .facets__form {
    display: flex;
    flex-flow: column;
    width: 100%;
    height: 100%;
    align-items: flex-start;
  }

  .facets:not(.facets--drawer) .facets__filters-wrapper {
    @media screen and (min-width: 750px) {
      margin-inline-end: var(--margin-md);
    }
  }

  /* sorting */
  .sorting-wrapper {
    flex: 1;
    justify-content: flex-end;
  }

  /* Facets - Summary */
  .facets__summary {
    --variant-picker-swatch-width: 32px;
    --variant-picker-swatch-height: 32px;
    --icon-opacity: 0.5;

    font-size: var(--body-s-font-size);
    padding: 0;
    display: flex;
    justify-content: space-between;

    &:hover {
      --icon-opacity: 1;
    }

    & > .svg-wrapper {
      margin-right: 0;
    }

    @media screen and (min-width: 750px) {
      --variant-picker-swatch-width: 26px;
      --variant-picker-swatch-height: 26px;
    }
  }

  .facets--panel-style-underline .blog-posts__sidebar-item summary,
  .facets--panel-style-underline .facets__summary {
    border-bottom: .1rem solid rgb(var(--color-foreground-rgb) / var(--opacity-10));
  }

  .facets__filters-wrapper:hover .facets__summary,
  .facets__filters-wrapper:has(.facets__panel[open]) .facets__summary {
    opacity: var(--facets-hover-opacity);
  }

  .facets__filters-wrapper .facets__summary:hover,
  .facets__filters-wrapper .facets__panel[open] .facets__summary {
    opacity: 1;
  }

  .facets__summary .icon-caret {
    height: var(--icon-size-xs);
    width: var(--icon-size-xs);
    color: rgb(var(--color-foreground-rgb) / var(--icon-opacity));
    margin-block: var(--margin-2xs);
    transition: color var(--animation-speed) var(--animation-easing),
      transform var(--animation-speed) var(--animation-easing);
  }

  .facets--drawer .facets__summary .icon-caret {
    margin-inline-start: var(--margin-2xs);
  }

  /* Facets - Bubble */
  .facets__bubble {
    display: inline-flex;
    font-family: var(--font-paragraph--family);
    font-weight: var(--font-paragraph--weight);
    aspect-ratio: 1 / 1;
    line-height: 1;
  }

  /* Facets - Inputs */
  .facets__inputs-wrapper {
    margin-block: var(--padding-xs) var(--padding-xs);
  }

  .facets__inputs .show-more {
    display: flex;
    flex-direction: column;
    gap: var(--gap-xl);
    margin-block-end: var(--padding-xl);
  }

  .facets:not(.facets--drawer) .facets__inputs-wrapper {
    @media screen and (min-width: 750px) {
      gap: var(--gap-sm);
    }
  }

  @media screen and (max-width: 749px) {
    .facets__inputs:has(.show-more) .facets__inputs-wrapper {
      padding-block: var(--padding-sm);
      padding-inline: var(--padding-sm);
      margin-block: calc(var(--padding-sm) * -1);
      margin-inline: calc(var(--padding-sm) * -1);
    }
  }

  .facets__inputs-wrapper:not(:has(.facets__inputs-list)),
  .facets__inputs-wrapper .facets__inputs-list {
    display: flex;
    gap: var(--facets-mobile-gap);
    flex-direction: column;

    @media screen and (min-width: 750px) {
      gap: var(--gap-sm);
    }
  }

  @media screen and (min-width: 750px) {
    .facets--horizontal
      .facets__inputs-wrapper
      .facets__inputs-list--swatches:not(.facets__inputs-list--swatches-grid) {
      display: grid;
      grid-template-columns: repeat(var(--swatch-columns, 4), 1fr);
    }
  }

  .facets__inputs-wrapper .facets__inputs-list--swatches {
    --facets-mobile-gap: var(--gap-sm);
  }

  .facets__inputs-wrapper .facets__inputs-list--grid {
    --min-column-width: 20%;

    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(var(--min-column-width), 1fr));
    gap: var(--gap-sm);

    @media screen and (min-width: 750px) {
      --min-column-width: 50px;
    }
  }

  .facets-block-wrapper:not(.facets-block-wrapper--vertical) .facets__inputs-list--grid {
    @media screen and (min-width: 750px) {
      width: var(--facets-grid-panel-width);
    }
  }

  .facets__inputs-wrapper--row:not(:has(.facets__inputs-list)),
  .facets__inputs-wrapper--row .facets__inputs-list {
    flex-wrap: wrap;
    flex-direction: row;
  }

  .facets__inputs .show-more__button {
    --show-more-icon-size: 22px;
    --show-more-gap: 8px;

    gap: var(--show-more-gap);

    @media screen and (min-width: 750px) {
      --show-more-icon-size: 16px;
      --show-more-gap: 6px;
    }
  }

  .facets__inputs .show-more__button .icon-plus {
    width: var(--show-more-icon-size);
    height: var(--show-more-icon-size);

    svg {
      width: var(--icon-size-xs);
      height: var(--icon-size-xs);
    }
  }

  /* Facets - Panel */
  .facets__panel {
    padding: 0 var(--drawer-padding);
  }

  .facets__panel .field__input {
    font-size: var(--body-xs-font-size);
  }

  .facets__panel--frame .facets__summary {
    border: var(--style-border-width) solid var(--color-foreground);
    border-radius: var(--style-border-radius-buttons-primary);
  }

  .facets__display {
    border-width: var(--style-border-width);
    border-style: solid;
    border-color: var(--color-foreground);
    border-radius: var(--style-border-radius-buttons-primary);
    box-shadow: var(--popup-shadow);
    background: var(--color-background);
    position: absolute;
    top: 100%;
    left: 0rem;
    width: 35rem;
    box-shadow: rgba(var(--color-shadow-rgb) / 0.2) 0px 0px 20px;
  }

  .facets:not(.facets--drawer) .facets__panel,
  .facets-controls-wrapper .facets__panel {
    @media screen and (min-width: 750px) {
      padding: 0;
    }
  }

  .facets-mobile-wrapper .facets__panel-content {
    border-radius: var(--style-border-radius-popover);
  }

  .facets-mobile-wrapper {
    --facets-upper-z-index: var(--layer-raised);
    --facets-panel-min-width: 120px;
    --facets-panel-height: 300px;
  }

  .facets--horizontal .facets__panel-content,
  .sorting-filter__options {
    @media screen and (min-width: 750px) {
      border-radius: var(--style-border-radius-popover);
      position: absolute;
      top: 100%;
      width: max-content;
      min-width: var(--facets-panel-min-width);
      max-width: var(--facets-panel-width);
      max-height: var(--facets-panel-height);
      z-index: var(--facets-upper-z-index);
      box-shadow: var(--style-shadow-popover);
      border: var(--style-border-popover);
      background: var(--color-background);
      overflow-y: hidden;
      gap: 0;
    }
  }

  :is(.facets--drawer, .facets--vertical) :is(.facets__item, .sorting-filter)::before {
    content: '';
    display: block;
    height: 0;
    width: calc(100% - var(--drawer-padding) * 2);
    border-top: var(--style-border-width) solid var(--color-border);
    margin: 0 auto;
  }

  @media screen and (min-width: 750px) {
    .facets--horizontal .facets__item:not(:first-of-type)::before,
    .facets--horizontal .sorting-filter::before {
      content: none;
    }
  }

  /* Facets - Text */
  .facets__label,
  .facets__clear-all,
  .clear-filter {
    text-decoration-color: transparent;
    text-decoration-thickness: 0.075em;
    text-underline-offset: 0.125em;
    transition: text-decoration-color var(--animation-speed) var(--animation-easing);
  }

  .facets__label,
  .products-count-wrapper {
    text-transform: var(--facet-label-transform);
  }

  .clear-filter {
    background-color: transparent;
    box-shadow: none;
    padding: 0;
  }

  /* Facets - Label */
  .facets__label {
    color: var(--color-foreground);
    cursor: pointer;
    font-size: var(--font-size, var(--body-s-font-size));
    margin: 0;
  }

  /* Facet checkbox */
  .facet-checkbox {
    padding: 0rem;
    flex-grow: 1;
    position: relative;
    font-size: var(--font-size, var(--body-xs-font-size));
    display: flex;
    align-items: center;
    word-break: break-word;
  }

  /* Products count */
  .products-count-wrapper {
    display: none;
  }

  /* Facets - Active facets */
  .active-facets {
    grid-column: 1 / -1;
    grid-row: 4;
    row-gap: var(--margin-xs);

    .results-count {
      font-size: var(--body-xs-font-size);
      color: rgba(var(--color-foreground-rgb) / var(--opacity-50));
    }

    @media screen and (max-width: 1024px) {
      margin: 0 -1.2rem 1.2rem;
    }

    @media screen and (min-width: 1025px) {
      grid-column: 1 / -1;
      grid-row: 2;
    }

    .mobile-facets & {
      row-gap: var(--margin-2xs);
    }
  }

  .active-facets-vertical-filter .active-facets__button-wrapper {
    margin-right: 0;
  }

  .active-facets-vertical-filter:not(:has(+ facet-remove)) .active-facets__button-wrapper {
    display: none;
  }

  .active-facets__button {
    margin-right: var(--margin-xs);
    padding: calc(var(--padding-2xs) + var(--padding-3xs)) var(--padding-sm);
    border: 1px solid rgba(var(--color-foreground-rgb) / 0.05);
    background: rgba(var(--color-foreground-rgb) / 0.05);
    transition: background var(--animation-speed-slow) var(--animation-timing-hover),
      border var(--animation-speed-slow) var(--animation-timing-hover),
      transform var(--animation-speed-slow) var(--animation-timing-hover);
  }

  @media (hover: hover) {
    facet-remove:hover .active-facets__button {
      background: rgba(var(--color-foreground-rgb) / 0.2);
      border: 1px solid rgba(var(--color-foreground-rgb) / 0.2);
      transform: translateY(-0.2rem);
    }
  }

  /* Mobile specific components */
  .facets__title-wrapper {
    background: var(--color-background);
    color: var(--color-foreground);
    position: sticky;
    top: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-block: var(--padding-xs);
    padding-inline-start: var(--drawer-padding);
    padding-inline-end: var(--padding-2xs);
    z-index: var(--facets-sticky-z-index);
  }

  :is(.facets--horizontal, .facets--vertical) .facets__title-wrapper {
    @media screen and (min-width: 750px) {
      display: none;
    }
  }

  .facets-drawer__title {
    --variant-picker-swatch-width: 32px;
    --variant-picker-swatch-height: 32px;

    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--gap-xs);

    @media screen and (min-width: 750px) {
      --variant-picker-swatch-width: 26px;
      --variant-picker-swatch-height: 26px;
    }
  }

  .facets-drawer__close {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    background-color: transparent;
    border: none;
    cursor: pointer;
    width: var(--minimum-touch-target);
    height: var(--minimum-touch-target);
    box-shadow: none;
  }

  /* Status */
  .facets__status {
    margin-left: var(--margin-xs);
  }

  .facets__header-vertical .facets__status {
    margin-left: 0;
  }

  .facets__status:not(:empty) {
    width: max-content;
    display: flex;
    font-weight: 500;
    color: var(--color-foreground);
  }

  .facets--filters-title {
    margin-block-end: 0;
    color: var(--color-foreground);
    height: fit-content;

    @media screen and (max-width: 749px) {
      display: none;
    }
  }

  /* Facets - Vertical */
  .facets--vertical {
    .active-facets-mobile {
      margin: 1.2rem 0;
      padding: 0rem var(--padding-sm);
    }
    .facets-layout-list {
      padding-block: var(--padding-xs);
      gap: var(--gap-md);
      display: flex;
      flex-flow: column;

      &.facets-layout-list--pill ,
      &:has(.swatch-item) {
        flex-direction: row;
        flex-wrap: wrap;
      }
    }
    .facets-wrap-vertical,
    .blog-posts__sidebar-item .details-content {
      padding: 0 0 var(--padding-xs);
      margin: var(--margin-sm) 0 0;
      font-size: var(--font-size--sm);
    }

    .blog-posts__sidebar-item summary {
      padding: var(--padding-sm);
    }

    &.facets--panel-style-frame .blog-posts__sidebar-item summary {
      border: var(--style-border-width) solid var(--color-foreground);
      border-radius: var(--style-border-radius-buttons-primary);
    }

    .facets__inputs:has(.show-more) .facets__inputs-wrapper {
      padding-block: var(--padding-sm);
      padding-inline: var(--padding-sm);
      margin-block: calc(var(--padding-sm) * -1);
      margin-inline: calc(var(--padding-sm) * -1);
    }

    &.facets--panel-style-underline .facets__summary,
    &.facets--panel-style-underline .blog-posts__sidebar-item summary {
      padding-inline: 0;
    }

    @media screen and (max-width: 1024px) {
      .facets-container {
        grid-template-columns: 1fr;
      }
    }

    @media screen and (min-width: 750px) {
      .facets__item:not(:first-of-type)::before,
      .sorting-filter::before {
        content: '';
      }

      .facets__inputs-wrapper .facets__inputs-list--swatches {
        gap: var(--gap-sm);
      }
    }

    @media screen and (min-width: 750px) {
      padding-block: 0 var(--padding-block-end);
      display: flex;
      flex-direction: column;
      position: auto;
      top: 0;
      bottom: auto;
      height: auto;
      max-height: none;
      width: auto;
      overflow: visible;
      gap: var(--filter-gap-vertical);
    }

    @media screen and (min-width: 1025px) {
      &.facets--vertical-sticky {
        position: sticky;
      }
    }
  }

  /* Facets - Horizontal */

  .facets--horizontal {
    display: flex;

    .facets__list {
      padding: 1rem 0;
      gap: var(--gap-md);
      display: flex;
      flex-flow: column;
    }

    .facet-filters__sort .facets__list {
      padding: .5rem 2rem;
    }

    @media screen and (min-width: 750px) {
      padding-block: var(--padding-block-start) var(--padding-block-end);
      align-items: center;
      position: relative;
      z-index: var(--facets-upper-z-index);
      border: none;
      height: auto;
      top: initial;
      bottom: initial;
      max-height: none;
      width: auto;
      overflow: visible;
    }

    .active-facets {
      margin-top: var(--margin-2xl);

      .active-facets__button-wrapper {
        margin-right: var(--margin-xs);
      }
    }

    .products-count-wrapper {
      @media screen and (min-width: 750px) {
        display: flex;
        margin-left: auto;
        flex-shrink: 0;
        align-items: center;
        height: var(--minimum-touch-target);
      }
    }

    .active-facets__button {
      margin-top: 0;
    }

    .facets__panel .facets__status:has(:not(:empty)) {
      @media screen and (min-width: 750px) {
        display: flex;
        margin-inline-start: var(--margin-xs);
        margin-inline-end: var(--margin-xs);
      }
    }

    .facets__form {
      @media screen and (min-width: 750px) {
        gap: 0 var(--facets-form-horizontal-gap);
        flex-flow: row nowrap;
        height: auto;

        &.facets__form--divider {
          flex-direction: column;
        }
      }
    }

    .facets__panel {
      @media screen and (min-width: 750px) {
        position: relative;
        width: fit-content;
      }
    }

    .facets__inputs .show-more {
      @media screen and (min-width: 750px) {
        display: contents;
      }
    }

    .facets__inputs-wrapper {
      @media screen and (min-width: 750px) {
        max-height: var(--facets-horizontal-max-input-wrapper-height);
        scrollbar-width: none;
        -ms-overflow-style: none;
        overflow-x: auto;
        padding: var(--padding-md);
        margin-block: 0;
      }
    }

    .facet-filters__field-label {
      font-size: var(--font-size);
    }

    .facets__summary {
      padding: var(--padding-xs) var(--padding-sm);
      min-width: 9rem;
      @media screen and (min-width: 750px) {
        font-size: var(--font-size);
        justify-content: flex-start;
        height: var(--minimum-touch-target);
      }
    }

    .facets__filters-wrapper {
      @media screen and (min-width: 750px) {
        max-width: 60%;
        display: flex;
        flex-wrap: wrap;
        column-gap: var(--gap-xl);
        margin-inline-end: 0;
      }
    }

    .facets__form:not(.facets__form--divider) .sorting-wrapper {
      flex-wrap: wrap;
    }

    .facets__form.facets__form--divider {
      .sorting-wrapper {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--margin-xl);
        width: 100%;

        @media screen and (min-width: 1025px) {
          grid-template-columns: 1fr max-content minmax(max-content, 1fr);
        }
      }

      .facets__form-wrapper {
        flex: 1 0 100%;
        max-width: 100%;
      }

      .divider__line {
        flex-basis: 100%;
        min-height: 100%;
        border-bottom: 1px solid var(--color-border);
      }
    }

    .facets__form-wrapper {
      @media screen and (min-width: 750px) {
        flex-direction: row;
        height: auto;
        align-items: flex-start;
        display: flex;
        gap: var(--margin-2xl);
        flex: 1 0 60%;
        max-width: 60%;
      }

      .facets__form-wrapper-inner {
        display: flex;
        flex-wrap: wrap;
        gap: var(--margin-2xl);
      }
    }

    .swatch-input-wrapper .swatch-input__label {
      display: flex;
      align-items: center;
      gap: var(--gap-xs);
      font-size: var(--font-size--sm);
    }

    .swatch-input-wrapper .swatch-input__label .visually-hidden {
      position: static !important;
      overflow: visible;
      width: auto;
      height: auto;
      margin: 0;
      padding: unset;
      border: initial;
      clip: auto;
      word-wrap: break-word !important;
    }

    .swatch-input-wrapper .swatch-input__label .facet-checkbox__text {
      position: absolute !important;
      overflow: hidden;
      width: 1px;
      height: 1px;
      margin: -1px;
      padding: 0;
      border: 0;
      clip: rect(0 0 0 0);
      word-wrap: normal !important;
    }
  }

  .collection-wrapper:has(> .facets--horizontal) .facets__panel[open] {
    @media screen and (min-width: 750px) {
      z-index: var(--facets-open-z-index);
    }
  }
{% endstylesheet %}
{% schema %}
{
  "name": "t:names.filters",
  "tag": null,
  "blocks": [
    {
      "type": "_blog-post-sidebar-products"
    },
    {
      "type": "_blog-post-sidebar-image"
    },
    {
      "type": "_blog-post-sidebar-text"
    }
  ],
  "settings": [
    {
      "type": "header",
      "content": "t:content.layout"
    },
    {
      "type": "select",
      "id": "filter_style",
      "label": "t:settings.direction",
      "options": [
        {
          "value": "horizontal",
          "label": "t:options.horizontal"
        },
        {
          "value": "vertical",
          "label": "t:options.vertical"
        }
      ],
      "default": "horizontal",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "select",
      "id": "filter_position",
      "label": "t:settings.position",
      "options": [
        {
          "value": "left",
          "label": "t:options.left"
        },
        {
          "value": "right",
          "label": "t:options.right"
        }
      ],
      "default": "left",
      "visible_if": "{{ block.settings.filter_style == 'vertical' }}"
    },
    {
      "type": "select",
      "id": "filter_width",
      "label": "t:settings.width",
      "options": [
        {
          "value": "centered",
          "label": "t:options.page"
        },
        {
          "value": "full-width",
          "label": "t:options.full"
        }
      ],
      "default": "centered",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.filter_style == 'horizontal' }}"
    },
    {
      "type": "select",
      "id": "heading_label_case",
      "label": "t:settings.heading_label_case",
      "options": [
        {
          "value": "normal-case",
          "label": "t:options.default"
        },
        {
          "value": "uppercase",
          "label": "t:options.uppercase"
        }
      ],
      "default": "normal-case",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "select",
      "id": "heading_label_font_size",
      "label": "Heading label size",
      "options": [
        {
          "value": "1.0rem",
          "label": "10px"
        },
        {
          "value": "1.2rem",
          "label": "12px"
        },
        {
          "value": "1.4rem",
          "label": "14px"
        },
        {
          "value": "1.6rem",
          "label": "16px"
        },
        {
          "value": "1.8rem",
          "label": "18px"
        },
        {
          "value": "2.0rem",
          "label": "20px"
        },
        {
          "value": "2.2rem",
          "label": "22px"
        },
        {
          "value": "2.4rem",
          "label": "24px"
        }
      ],
      "default": "1.2rem",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "select",
      "id": "text_label_case",
      "label": "t:settings.text_label_case",
      "options": [
        {
          "value": "normal-case",
          "label": "t:options.default"
        },
        {
          "value": "uppercase",
          "label": "t:options.uppercase"
        }
      ],
      "default": "normal-case",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "select",
      "id": "text_label_font_size",
      "label": "Text label size",
      "options": [
        {
          "value": "1.0rem",
          "label": "10px"
        },
        {
          "value": "1.2rem",
          "label": "12px"
        },
        {
          "value": "1.4rem",
          "label": "14px"
        },
        {
          "value": "1.6rem",
          "label": "16px"
        },
        {
          "value": "1.8rem",
          "label": "18px"
        },
        {
          "value": "2.0rem",
          "label": "20px"
        }
      ],
      "default": "1.6rem",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "select",
      "id": "style",
      "label": "t:settings.style",
      "options": [
        {
          "value": "default",
          "label": "t:options.default"
        },
        {
          "value": "frame",
          "label": "t:options.frame"
        },
        {
          "value": "underline",
          "label": "t:options.underline"
        }
      ],
      "default": "default"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_filters",
      "label": "t:settings.make_details_sticky_desktop",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_hover_reveal",
      "label": "t:settings.hover_reveal",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_divider",
      "label": "t:settings.divider",
      "default": true,
      "visible_if": "{{ block.settings.filter_style == 'horizontal' }}"
    },
    {
      "type": "header",
      "content": "t:content.appearance"
    },
    {
      "type": "range",
      "id": "divider_spacing_top",
      "label": "t:settings.spacing_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0,
      "visible_if": "{{ block.settings.filter_style == 'horizontal' and block.settings.enable_divider == true }}"
    },
    {
      "type": "range",
      "id": "divider_spacing_bottom",
      "label": "t:settings.spacing_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0,
      "visible_if": "{{ block.settings.filter_style == 'horizontal' and block.settings.enable_divider == true }}"
    },
    {
      "type": "color",
      "id": "divider_color",
      "label": "t:settings.color",
      "alpha": true,
      "default": "#000000",
      "visible_if": "{{ block.settings.filter_style == 'horizontal' and block.settings.enable_divider == true }}"
    },
    {
      "type": "checkbox",
      "id": "inherit_color_scheme",
      "label": "t:settings.inherit_color_scheme",
      "default": true
    },
    {
      "type": "color",
      "id": "scheme_background",
      "label": "t:settings.background",
      "default": "#FFFFFF",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color_background",
      "id": "scheme_background_gradient",
      "label": "t:settings.background_gradient",
      "info": "t:info.background_gradient_info",
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "scheme_foreground_heading",
      "label": "t:settings.headings",
      "default": "#000000",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "scheme_foreground",
      "label": "t:settings.text",
      "default": "#000000",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "scheme_primary",
      "label": "t:settings.primary_color",
      "default": "#000F9F",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "scheme_primary_hover",
      "label": "t:settings.primary_hover_color",
      "default": "#000000",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "scheme_border",
      "label": "t:settings.borders",
      "default": "#E6E6E6",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "scheme_shadow",
      "label": "t:settings.shadow_color",
      "default": "#000000",
      "alpha": true,
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "header",
      "content": "t:settings.enable_filtering"
    },
    {
      "type": "checkbox",
      "id": "enable_filtering",
      "label": "t:settings.enable",
      "info": "t:info.enable_filtering_info",
      "default": false
    },
    {
      "type": "range",
      "id": "filter_gap_vertical",
      "label": "t:settings.vertical_gap",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 16,
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.filter_style == 'vertical' }}"
    },
    {
      "type": "checkbox",
      "id": "show_swatch_label",
      "label": "t:settings.show_swatch_label",
      "default": false,
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "checkbox",
      "id": "show_filter_label",
      "label": "t:settings.show_filter_label",
      "default": false,
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "text",
      "id": "filter_variant_pill",
      "default": "Size",
      "label": "t:settings.filter_variant_pill",
      "info": "t:info.filter_variant_pill_info",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "text",
      "id": "filter_swatch",
      "default": "Color",
      "label": "t:settings.input_option_name_to_show_swatch_style",
      "info": "t:info.filter_variant_pill_info",
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "checkbox",
      "id": "show_filter_by_tags_sidebar",
      "label": "t:settings.show_filter_by_tags_sidebar",
      "default": false,
      "visible_if": "{{ block.settings.enable_filtering == true }}"
    },
    {
      "type": "text",
      "id": "filter_label_all",
      "label": "t:settings.filter_label_for_all_tags",
      "info": "t:info.filter_label_for_all_tags_info",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true }}"
    },
    {
      "type": "range",
      "id": "number_filters",
      "label": "t:settings.number_of_filters",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 1,
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true }}"
    },
    {
      "type": "text",
      "id": "fbt_heading_1",
      "label": "t:settings.heading_1",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true }}"
    },
    {
      "type": "textarea",
      "id": "fbt_tags_list_1",
      "label": "t:settings.tags_list_1",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true }}"
    },
    {
      "type": "text",
      "id": "fbt_heading_2",
      "label": "t:settings.heading_2",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters > 1 }}"
    },
    {
      "type": "textarea",
      "id": "fbt_tags_list_2",
      "label": "t:settings.tags_list_2",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters > 1 }}"
    },
    {
      "type": "text",
      "id": "fbt_heading_3",
      "label": "t:settings.heading_3",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters > 2 }}"
    },
    {
      "type": "textarea",
      "id": "fbt_tags_list_3",
      "label": "t:settings.tags_list_3",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters > 2 }}"
    },
    {
      "type": "text",
      "id": "fbt_heading_4",
      "label": "t:settings.heading_4",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters > 3 }}"
    },
    {
      "type": "textarea",
      "id": "fbt_tags_list_4",
      "label": "t:settings.tags_list_4",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters > 3 }}"
    },
    {
      "type": "text",
      "id": "fbt_heading_5",
      "label": "t:settings.heading_5",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters == 5 }}"
    },
    {
      "type": "textarea",
      "id": "fbt_tags_list_5",
      "label": "t:settings.tags_list_5",
      "visible_if": "{{ block.settings.enable_filtering == true and block.settings.show_filter_by_tags_sidebar == true and block.settings.number_filters == 5 }}"
    },
    {
      "type": "header",
      "content": "t:settings.enable_sorting"
    },
    {
      "type": "checkbox",
      "id": "enable_divider_sorting_vertical",
      "label": "t:settings.desktop_divider",
      "default": true,
      "visible_if": "{{ block.settings.filter_style == 'vertical' }}"
    },
    {
      "type": "checkbox",
      "id": "enable_sorting",
      "label": "t:settings.enable",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_count",
      "label": "Enable product count",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_items_per_page",
      "label": "t:settings.enable_items_per_page",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_grid_density",
      "label": "t:settings.enable_grid_density",
      "default": true
    },
    {
      "type": "range",
      "id": "sorting_vertical_padding_block_start",
      "label": "t:settings.top_padding",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0,
      "visible_if": "{{ block.settings.enable_sorting == true and block.settings.filter_style == 'vertical' }}"
    },
    {
      "type": "range",
      "id": "sorting_vertical_padding_block_end",
      "label": "t:settings.bottom_padding",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0,
      "visible_if": "{{ block.settings.enable_sorting == true and block.settings.filter_style == 'vertical' }}"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "t:content.margin"
    },
    {
      "type": "range",
      "id": "facets_margin_bottom",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 8,
      "visible_if": "{{ block.settings.filter_style == 'horizontal' }}"
    },
    {
      "type": "range",
      "id": "facets_margin_right",
      "label": "t:settings.right",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 20,
      "visible_if": "{{ block.settings.filter_style == 'vertical' and block.settings.filter_position == 'left' }}"
    },
    {
      "type": "range",
      "id": "facets_margin_left",
      "label": "t:settings.left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 20,
      "visible_if": "{{ block.settings.filter_style == 'vertical' and block.settings.filter_position == 'right' }}"
    }
  ]
}
{% endschema %}

{%- liquid
    assign section_id = section.id
    assign card_product = block.settings.product

    assign product_swatch_option = settings.swatch | downcase
    assign isColor = false
    assign variant_img = ''
    for option in card_product.options_with_values
    assign option_name = option.name | downcase
    if product_swatch_option contains option_name
        assign isColor = true
        assign index = forloop.index0
        assign position = forloop.index | minus: 1
        assign variant_selected = option.selected_value
        if settings.show_quick_shop
            for variant in card_product.variants limit: 1
                if variant.image != null  
                    assign variant_img = variant.image
                endif
            endfor
        endif
        break
    else 
        assign position = 0
        assign variant_selected = nil
    endif
    endfor
-%}

{%- if card_product and card_product != empty -%}
    <div class="card--block-variant">
        {%- render 'product-swatch', product: card_product, variant_selected: variant_selected, index: index -%}
    </div>
{%- endif -%}

{% schema %}
    {
        "name": "Product variant",
        "tag": null,
        "settings": [
            {
                "type": "product",
                "id": "product",
                "label": "t:sections.collage.blocks.product.settings.product.label"
            }
        ],
        "presets": [
            {
                "name": "Product variant",
                "settings": {
                    "product": "{{ closest.product }}"
                }
            }
        ]
    }
{% endschema %}

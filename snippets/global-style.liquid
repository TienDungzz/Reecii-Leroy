{%- liquid
  assign body_font_bold = settings.type_body_font | font_modify: 'weight', 'bold'
  assign body_font_italic = settings.type_body_font | font_modify: 'style', 'italic'
  assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic'
-%}
{% style %}
  {{ settings.type_body_font | font_face: font_display: 'swap' }}
  {{ body_font_bold | font_face: font_display: 'swap' }}
  {{ body_font_italic | font_face: font_display: 'swap' }}
  {{ body_font_bold_italic | font_face: font_display: 'swap' }}
  {{ settings.type_header_font | font_face: font_display: 'swap' }}

  {% for scheme in settings.color_schemes -%}
    {% assign scheme_classes = scheme_classes | append: ', .color-' | append: scheme.id %}
    {% if forloop.index == 1 -%}
      :root,
    {%- endif %}
    .color-{{ scheme.id }} {
      --color-background: {{ scheme.settings.background.red }} {{ scheme.settings.background.green }} {{ scheme.settings.background.blue }} / {{ scheme.settings.background.alpha }};
      {% if scheme.settings.background_gradient != empty %}
        --gradient-background: {{ scheme.settings.background_gradient }};
      {% else %}
        --gradient-background: {{ scheme.settings.background }};
      {% endif %}

      {% liquid
        assign background_color = scheme.settings.background
        assign background_color_brightness = background_color | color_brightness
        if background_color_brightness <= 26
            assign background_color_contrast = background_color | color_lighten: 50
        elsif background_color_brightness <= 65
            assign background_color_contrast = background_color | color_lighten: 5
        else
            assign background_color_contrast = background_color | color_darken: 25
        endif
      %}

          --color-foreground: {{ scheme.settings.text.red }},{{ scheme.settings.text.green }},{{ scheme.settings.text.blue }};
          --color-background-contrast: {{ background_color_contrast.red }},{{ background_color_contrast.green }},{{ background_color_contrast.blue }};
          --color-shadow: {{ scheme.settings.shadow.red }},{{ scheme.settings.shadow.green }},{{ scheme.settings.shadow.blue }};
          --color-border: rgba({{ scheme.settings.border.rgba }});
          --color-button: {{ scheme.settings.button.red }},{{ scheme.settings.button.green }},{{ scheme.settings.button.blue }};
          --color-button-text: {{ scheme.settings.button_label.red }},{{ scheme.settings.button_label.green }},{{ scheme.settings.button_label.blue }};
          --color-secondary-button: {{ scheme.settings.background.red }} {{ scheme.settings.background.green }} {{ scheme.settings.background.blue }} / {{ scheme.settings.background.alpha }};
          --color-secondary-button-text: {{ scheme.settings.secondary_button_label.red }},{{ scheme.settings.secondary_button_label.green }},{{ scheme.settings.secondary_button_label.blue }};
          --color-link: {{ scheme.settings.secondary_button_label.red }},{{ scheme.settings.secondary_button_label.green }},{{ scheme.settings.secondary_button_label.blue }};

          /* -------------------------------------------- BADGE COLOR -------------------------------------------- */
          --color-sale-badge-foreground: {{ scheme.settings.sale_badge_color.red }},{{ scheme.settings.sale_badge_color.green }},{{ scheme.settings.sale_badge_color.blue }};
          --color-sale-badge-background: {{ scheme.settings.sale_badge_background.red }} {{ scheme.settings.sale_badge_background.green }} {{ scheme.settings.sale_badge_background.blue }} / {{ scheme.settings.sale_badge_background.alpha }};
          --color-sale-badge-border: 
            {% if scheme.settings.sale_badge_background.red == 255 and scheme.settings.sale_badge_background.green == 255 and scheme.settings.sale_badge_background.blue == 255 %}
                {{ scheme.settings.sale_badge_color.red }},{{ scheme.settings.sale_badge_color.green }},{{ scheme.settings.sale_badge_color.blue }}
            {% else %}
                {{ scheme.settings.sale_badge_background.red }},{{ scheme.settings.sale_badge_background.green }},{{ scheme.settings.sale_badge_background.blue }}
            {% endif %};
          
          --color-sold-out-badge-foreground: {{ scheme.settings.sold_out_badge_color.red }},{{ scheme.settings.sold_out_badge_color.green }},{{ scheme.settings.sold_out_badge_color.blue }};
          --color-sold-out-badge-background: {{ scheme.settings.sold_out_badge_background.red }} {{ scheme.settings.sold_out_badge_background.green }} {{ scheme.settings.sold_out_badge_background.blue }} / {{ scheme.settings.sold_out_badge_background.alpha }};
          --color-sold-out-badge-border: 
            {% if scheme.settings.sold_out_badge_background.red == 255 and scheme.settings.sold_out_badge_background.green == 255 and scheme.settings.sold_out_badge_background.blue == 255 %}
                {{ scheme.settings.sold_out_badge_color.red }},{{ scheme.settings.sold_out_badge_color.green }},{{ scheme.settings.sold_out_badge_color.blue }}
            {% else %}
                {{ scheme.settings.sold_out_badge_background.red }},{{ scheme.settings.sold_out_badge_background.green }},{{ scheme.settings.sold_out_badge_background.blue }}
            {% endif %};
          
          --color-new-badge-foreground: {{ scheme.settings.new_badge_color.red }},{{ scheme.settings.new_badge_color.green }},{{ scheme.settings.new_badge_color.blue }};
          --color-new-badge-background: {{ scheme.settings.new_badge_background.red }} {{ scheme.settings.new_badge_background.green }} {{ scheme.settings.new_badge_background.blue }} / {{ scheme.settings.new_badge_background.alpha }};
          --color-new-badge-border: 
            {% if scheme.settings.new_badge_background.red == 255 and scheme.settings.new_badge_background.green == 255 and scheme.settings.new_badge_background.blue == 255 %}
                {{ scheme.settings.new_badge_color.red }},{{ scheme.settings.new_badge_color.green }},{{ scheme.settings.new_badge_color.blue }}
            {% else %}
                {{ scheme.settings.new_badge_background.red }},{{ scheme.settings.new_badge_background.green }},{{ scheme.settings.new_badge_background.blue }}
            {% endif %};
          
          --color-custom-badge-foreground: {{ scheme.settings.custom_badge_color.red }},{{ scheme.settings.custom_badge_color.green }},{{ scheme.settings.custom_badge_color.blue }};
          --color-custom-badge-background: {{ scheme.settings.custom_badge_background.red }} {{ scheme.settings.custom_badge_background.green }} {{ scheme.settings.custom_badge_background.blue }} / {{ scheme.settings.custom_badge_background.alpha }};
          --color-custom-badge-border: 
            {% if scheme.settings.custom_badge_background.red == 255 and scheme.settings.custom_badge_background.green == 255 and scheme.settings.custom_badge_background.blue == 255 %}
                {{ scheme.settings.custom_badge_color.red }},{{ scheme.settings.custom_badge_color.green }},{{ scheme.settings.custom_badge_color.blue }}
            {% else %}
                {{ scheme.settings.custom_badge_background.red }},{{ scheme.settings.custom_badge_background.green }},{{ scheme.settings.custom_badge_background.blue }}
            {% endif %};
          
          /* -------------------------------------------- END BADGE COLOR -------------------------------------------- */

          --payment-terms-background-color: rgb({{ scheme.settings.background.rgb }});
            --wishtlist-button-color: {{ scheme.settings.wishlist_icon }};
            --wishtlist-button-background: {{ scheme.settings.wishlist_background }};
            --quickview-button-color: {{ scheme.settings.quick_view_icon }};
            --quickview-button-background: {{ scheme.settings.quick_view_background }};
            --compare-button-color: {{ scheme.settings.compare_icon }};
            --compare-button-background: {{ scheme.settings.compare_background }};

            /* Arrows */
            --arrow-color: rgba({{ scheme.settings.arrow_color.rgba }});
            --arrow-background: rgba({{ scheme.settings.arrow_background.rgba }});
            --arrow-border: rgba({{ scheme.settings.arrow_border.rgba }});
      }
  {% endfor %}

  {{ scheme_classes | prepend: 'body' }} {
    color: rgba(var(--color-foreground), 1);
    background-color: rgb(var(--color-background));
  }

  :root {
    
    /* Line height / Leading */
    /* --- Body --- */
    --body-3xl-font-size: 2.8rem;
    --body-2xl-font-size: 2.4rem;
    --body-xl-font-size: 2.0rem;
    --body-l-font-size: 1.8rem;
    --body-m-font-size: 1.6rem;
    --body-s-font-size: 1.4rem;
    --body-xs-font-size: 1.2rem;
    --body-xxs-font-size: 1.0rem;

    --body-3xl-line-height: 4.2rem; /* 1.5 */
    --body-2xl-line-height: 3.6rem; /* 1.5 */
    --body-xl-line-height: 3.0rem; /* 1.5 */
    --body-l-line-height: 2.6rem; /* 1.4 */
    --body-m-line-height: 2.4rem; /* 1.5 */
    --body-s-line-height: 2rem; /* 1.4 */
    --body-xs-line-height: 1.8rem; /* 1.5 */
    --body-xxs-line-height: 1.4rem; /* 1.4 */

    --line-height--body-tight: 1.2;
    --line-height--body-normal: 1.4;
    --line-height--body-medium: 1.5;
    --line-height--body-loose: 1.75;

    /* --- Heading --- */
    {%- liquid
       assign font_sizes = "h1, h2, h3, h4, h5, h6" | split: ", "
       for font_size in font_sizes
        assign size_setting = 'heading_font_size_' | append: font_size
        assign font_size_value = settings[size_setting]
        assign font_size_value_px = font_size_value | times: 1.0 | divided_by: 10.0
        assign font_size_value_rem = font_size_value_px | append: "rem"

        echo '--font-size--' | append: font_size | append: ': ' | append: font_size_value_rem | append: ';'
       endfor
    -%}

    /* Letter-spacing / Tracking */
    --letter-spacing--display-tight: -0.03em;
    --letter-spacing--display-normal: 0;
    --letter-spacing--display-loose: 0.03em;

    --letter-spacing--heading-tight: -0.03em;
    --letter-spacing--heading-normal: 0;
    --letter-spacing--heading-loose: 0.03em;

    --letter-spacing--body-tight: -0.03em;
    --letter-spacing--body-normal: 0;
    --letter-spacing--body-loose: 0.03em;

    /* --- Heading --- */
    {%- liquid
       assign font_sizes = "h1, h2, h3, h4, h5, h6" | split: ", "
       for font_size in font_sizes
        assign tracking_setting = 'heading_letter_spacing_' | append: font_size
        assign tracking_value = settings[tracking_setting]
        echo '--letter-spacing--' | append: font_size | append: ': var(--letter-spacing--heading-' | append: tracking_value | append: ');'
       endfor
    -%}

    /* Text transform */
    --text-transform--none: none;
    --text-transform--uppercase: uppercase;
    --text-transform--capitalize: capitalize;

    {%- liquid
       assign font_sizes = "h1, h2, h3, h4, h5, h6" | split: ", "
       for font_size in font_sizes
        assign text_transform_setting = 'heading_text_transform_' | append: font_size
        assign text_transform_value = settings[text_transform_setting]
        echo '--text-transform--' | append: font_size | append: ': var(--text-transform--' | append: text_transform_value | append: ');'
       endfor
    -%}

    /* Font heading */
    --font-heading-family: {{ settings.type_header_font.family }}, {{ settings.type_header_font.fallback_families }};
    --font-heading-style: {{ settings.type_header_font.style }};
    --font-heading-weight: {{ settings.type_header_font.weight }};

    --font-body-scale: {{ settings.body_scale | divided_by: 100.0 }};
    --font-heading-scale: {{ settings.heading_scale | times: 1.0 | divided_by: settings.body_scale }};

    /* Page layout */
    --page-margin: 1.6rem;
    --page-content-width: {{ settings.page_width | divided_by: 10 }}rem;
    --page-width: calc(var(--page-content-width) + var(--page-margin) * 2);

    /* Product card */
    --product-card-image-padding: {{ settings.card_image_padding | divided_by: 10.0 }}rem;
    --product-card-corner-radius: {{ settings.card_corner_radius | divided_by: 10.0 }}rem;
    --product-card-text-alignment: {{ settings.card_text_alignment }};
    --product-card-border-width: {{ settings.card_border_thickness | divided_by: 10.0 }}rem;
    --product-card-border-opacity: {{ settings.card_border_opacity | divided_by: 100.0 }};
    --product-card-shadow-opacity: {{ settings.card_shadow_opacity | divided_by: 100.0 }};
    --product-card-shadow-visible: {% if settings.card_shadow_opacity > 0 %}1{% else %}0{% endif %};
    --product-card-shadow-horizontal-offset: {{ settings.card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
    --product-card-shadow-vertical-offset: {{ settings.card_shadow_vertical_offset | divided_by: 10.0 }}rem;
    --product-card-shadow-blur-radius: {{ settings.card_shadow_blur | divided_by: 10.0 }}rem;

    /* Collection card */
    --collection-card-image-padding: {{ settings.collection_card_image_padding | divided_by: 10.0 }}rem;
    --collection-card-corner-radius: {{ settings.collection_card_corner_radius | divided_by: 10.0 }}rem;
    --collection-card-text-alignment: {{ settings.collection_card_text_alignment }};
    --collection-card-border-width: {{ settings.collection_card_border_thickness | divided_by: 10.0 }}rem;
    --collection-card-border-opacity: {{ settings.collection_card_border_opacity | divided_by: 100.0 }};
    --collection-card-shadow-opacity: {{ settings.collection_card_shadow_opacity | divided_by: 100.0 }};
    --collection-card-shadow-visible: {% if settings.collection_card_shadow_opacity > 0 %}1{% else %}0{% endif %};
    --collection-card-shadow-horizontal-offset: {{ settings.collection_card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
    --collection-card-shadow-vertical-offset: {{ settings.collection_card_shadow_vertical_offset | divided_by: 10.0 }}rem;
    --collection-card-shadow-blur-radius: {{ settings.collection_card_shadow_blur | divided_by: 10.0 }}rem;

    /* Blog card */
    --blog-card-image-padding: {{ settings.blog_card_image_padding | divided_by: 10.0 }}rem;
    --blog-card-corner-radius: {{ settings.blog_card_corner_radius | divided_by: 10.0 }}rem;
    --blog-card-text-alignment: {{ settings.blog_card_text_alignment }};
    --blog-card-border-width: {{ settings.blog_card_border_thickness | divided_by: 10.0 }}rem;
    --blog-card-border-opacity: {{ settings.blog_card_border_opacity | divided_by: 100.0 }};
    --blog-card-shadow-opacity: {{ settings.blog_card_shadow_opacity | divided_by: 100.0 }};
    --blog-card-shadow-visible: {% if settings.blog_card_shadow_opacity > 0 %}1{% else %}0{% endif %};
    --blog-card-shadow-horizontal-offset: {{ settings.blog_card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
    --blog-card-shadow-vertical-offset: {{ settings.blog_card_shadow_vertical_offset | divided_by: 10.0 }}rem;
    --blog-card-shadow-blur-radius: {{ settings.blog_card_shadow_blur | divided_by: 10.0 }}rem;

    /* Badge */
    --badge-corner-radius: {{ settings.badge_corner_radius | divided_by: 10.0 }}rem;

    /* Spacing section */
    --spacing-sections-desktop: {{ settings.spacing_sections }}px;
    --spacing-sections-mobile: {% if settings.spacing_sections < 24 %}{{ settings.spacing_sections }}{% else %}{{ settings.spacing_sections | times: 0.7 | round | at_least: 20 }}{% endif %}px;

    /* Grid */
    --grid-desktop-vertical-spacing: {{ settings.spacing_grid_vertical }}px;
    --grid-desktop-horizontal-spacing: {{ settings.spacing_grid_horizontal }}px;
    --grid-mobile-vertical-spacing: {{ settings.spacing_grid_vertical | divided_by: 2 }}px;
    --grid-mobile-horizontal-spacing: {{ settings.spacing_grid_horizontal | divided_by: 2 }}px;

    /* Buttons */
    --buttons-radius: {{ settings.buttons_radius }}px;
    --buttons-radius-outset: {% if settings.buttons_radius > 0 %}{{ settings.buttons_radius | plus: settings.buttons_border_thickness }}{% else %}0{% endif %}px;
    --buttons-border-width: {% if settings.buttons_border_opacity > 0 %}{{ settings.buttons_border_thickness }}{% else %}0{% endif %}px;
    --buttons-border-opacity: {{ settings.buttons_border_opacity | divided_by: 100.0 }};
    --buttons-shadow-opacity: {{ settings.buttons_shadow_opacity | divided_by: 100.0 }};
    --buttons-shadow-visible: {% if settings.buttons_shadow_opacity > 0 %}1{% else %}0{% endif %};
    --buttons-shadow-horizontal-offset: {{ settings.buttons_shadow_horizontal_offset }}px;
    --buttons-shadow-vertical-offset: {{ settings.buttons_shadow_vertical_offset }}px;
    --buttons-shadow-blur-radius: {{ settings.buttons_shadow_blur }}px;
    --buttons-border-offset: {% if settings.buttons_radius > 0 or settings.buttons_shadow_opacity > 0 %}0.3{% else %}0{% endif %}px;

    /* Inputs */
    --inputs-radius: {{ settings.inputs_radius }}px;
    --inputs-border-width: {{ settings.inputs_border_thickness }}px;
    --inputs-border-opacity: {{ settings.inputs_border_opacity | divided_by: 100.0 }};
    --inputs-shadow-opacity: {{ settings.inputs_shadow_opacity | divided_by: 100.0 }};
    --inputs-shadow-horizontal-offset: {{ settings.inputs_shadow_horizontal_offset }}px;
    --inputs-margin-offset: {% if settings.inputs_shadow_vertical_offset != 0 and settings.inputs_shadow_opacity > 0 %}{{ settings.inputs_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
    --inputs-shadow-vertical-offset: {{ settings.inputs_shadow_vertical_offset }}px;
    --inputs-shadow-blur-radius: {{ settings.inputs_shadow_blur }}px;
    --inputs-radius-outset: {% if settings.inputs_radius > 0 %}{{ settings.inputs_radius | plus: settings.inputs_border_thickness }}{% else %}0{% endif %}px;

    /* Variant pills */
    --variant-pills-radius: {{ settings.variant_pills_radius }}px;
    --variant-pills-border-width: {{ settings.variant_pills_border_thickness }}px;
    --variant-pills-border-opacity: {{ settings.variant_pills_border_opacity | divided_by: 100.0 }};
    --variant-pills-shadow-opacity: {{ settings.variant_pills_shadow_opacity | divided_by: 100.0 }};
    --variant-pills-shadow-horizontal-offset: {{ settings.variant_pills_shadow_horizontal_offset }}px;
    --variant-pills-shadow-vertical-offset: {{ settings.variant_pills_shadow_vertical_offset }}px;
    --variant-pills-shadow-blur-radius: {{ settings.variant_pills_shadow_blur }}px;

    /* Swatch input */
    --swatch-input--size: {{ settings.variant_swatch_size | times: 0.1 }}rem;

    /* Localization */
    --localization-radius: {{ settings.inputs_radius }}px;
    --localization-border-width: 0.1rem;
    --localization-border-opacity: 0.1;
    --localization-corner-radius: 1rem;
    --localization-shadow: 0 1rem 2rem rgba(40, 40, 40, 0.08);

    /* Popup */
    --popup-border-width: 0.1rem;
    --popup-border-opacity: 0.1;
    --popup-corner-radius: 1rem;
    --popup-shadow: 0 1rem 2rem rgba(40, 40, 40, 0.08);

    /* Quantity */
    --quantity-color-background: var(--color-foreground);
    --quantity-radius: {{ settings.inputs_radius }}px;
    --quantity-border-width: 0.1rem;
    --quantity-border-opacity: 0;
    --quantity-shadow: none;

    /* Spacing */
    --sp-1: 0.1rem;
    --sp-2: 0.2rem;
    --sp-3: 0.3rem;
    --sp-4: 0.4rem;
    --sp-5: 0.5rem;
    --sp-6: 0.6rem;
    --sp-7: 0.7rem;
    --sp-8: 0.8rem;
    --sp-9: 0.9rem;
    --sp-10: 1rem;
    --sp-11: 1.1rem;
    --sp-12: 1.2rem;
    --sp-13: 1.3rem;
    --sp-14: 1.4rem;
    --sp-15: 1.5rem;
    --sp-16: 1.6rem;
    --sp-17: 1.7rem;
    --sp-18: 1.8rem;
    --sp-19: 1.9rem;
    --sp-20: 2rem;
    --sp-21: 2.1rem;
    --sp-22: 2.2rem;
    --sp-23: 2.3rem;
    --sp-24: 2.4rem;
    --sp-25: 2.5rem;
    --sp-26: 2.6rem;
    --sp-27: 2.7rem;
    --sp-28: 2.8rem;
    --sp-29: 2.9rem;
    --sp-30: 3rem;
    --sp-31: 3.1rem;
    --sp-32: 3.2rem;
    --sp-33: 3.3rem;
    --sp-34: 3.4rem;
    --sp-35: 3.5rem;
    --sp-36: 3.6rem;
    --sp-37: 3.7rem;
    --sp-38: 3.8rem;
    --sp-39: 3.9rem;
    --sp-40: 4rem;
    --sp-41: 4.1rem;
    --sp-42: 4.2rem;
    --sp-43: 4.3rem;
    --sp-44: 4.4rem;
    --sp-45: 4.5rem;
    --sp-46: 4.6rem;
    --sp-47: 4.7rem;
    --sp-48: 4.8rem;

    --spacing-scale-sm: 0.6;
    --spacing-scale-md: 0.7;
    --spacing-scale-default: 1.0;

    /** Z-Index / Layering */
    --layer-section-background: -2;

    --font-body-family: {{ settings.type_body_font.family }}, {{ settings.type_body_font.fallback_families }};
    --font-body-style: {{ settings.type_body_font.style }};
    --font-body-weight: {{ settings.type_body_font.weight }};
    --font-body-weight-bold: {{ settings.type_body_font.weight | plus: 300 | at_most: 1000 }};

    --font-body-size: {{ settings.body_font_size | divided_by: 10.0 }}rem;
    --font-body-line-height: var(--line-height--body-{{ settings.body_line_height }});
  }

  @media screen and (width >= 750px) {
    :root {
      --page-margin: 4rem;
    }
  }

  *,
  *::before,
  *::after {
    box-sizing: inherit;
  }

  html {
    box-sizing: border-box;
    font-size: calc(var(--font-body-scale) * 62.5%);
    height: 100%;
  }

  body {
    display: grid;
    grid-template-rows: auto auto 1fr auto;
    grid-template-columns: 100%;
    min-height: 100%;
    margin: 0;
    font-size: calc(var(--font-body-scale) * var(--font-body-size));
    line-height: calc(var(--font-body-line-height) / var(--font-body-scale));
    font-family: var(--font-body-family);
    font-style: var(--font-body-style);
    font-weight: var(--font-body-weight);
  }


{% endstyle %}
{%- unless settings.type_body_font.system? -%}
  {% comment %}theme-check-disable AssetPreload{% endcomment %}
  <link rel="preload" as="font" href="{{ settings.type_body_font | font_url }}" type="font/woff2" crossorigin>
  {% comment %}theme-check-enable AssetPreload{% endcomment %}
{%- endunless -%}
{%- unless settings.type_header_font.system? -%}
  {% comment %}theme-check-disable AssetPreload{% endcomment %}
  <link rel="preload" as="font" href="{{ settings.type_header_font | font_url }}" type="font/woff2" crossorigin>
  {% comment %}theme-check-enable AssetPreload{% endcomment %}
{%- endunless -%}

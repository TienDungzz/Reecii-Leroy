{% comment %}
    Renders a header functions.

    Accepts:
    - enable_menu_drawer: {Boolean}
    - enable_localization: {Boolean}
    - enable_search: {Boolean}
    - enable_account: {Boolean}
    - enable_cart: {Boolean}

    Usage:
    {% render 'header-functions', section: section %}
{% endcomment %}

{%- if enable_menu_drawer -%}
    <side-drawer-opener
        class="header__icon header__icon--menu header__icon--summary dis-flex a-i-center j-c-center"
        data-side-drawer="#Drawer-Menu"
    >
        <button class="t-button bor-none c-pointer pad-0 wid-100 hei-100 color-foreground bg-transparent focus-inset"
            type="button"
            aria-haspopup="dialog"
            aria-label="{{ 'sections.header.menu' | t }}"
        >
            <span>
                {{- 'icon-hamburger.svg' | inline_asset_content -}}
            </span>
        </button>
    </side-drawer-opener>

    {% render 'header-drawer' %}
{%- endif -%}

{%- if enable_localization -%}
    <div class="desktop-localization-wrapper {{block.settings.enable_country_selector}}">
        {%- if block.settings.enable_country_selector and localization.available_countries.size > 1 -%}
            <localization-form class="small-hide medium-hide" data-prevent-hide activate-event="hover">
                {%- form 'localization', id: 'HeaderCountryForm', class: 'localization-form' -%}
                    <div>
                        <h2 class="visually-hidden" id="HeaderCountryLabel">{{ 'localization.country_label' | t }}</h2>
                        {%- render 'country-localization', localPosition: 'HeaderCountry' -%}
                    </div>
                {%- endform -%}
            </localization-form>
        {% endif %}

        {%- if block.settings.enable_language_selector and localization.available_languages.size > 1 -%}
            <localization-form class="small-hide medium-hide" data-prevent-hide activate-event="hover">
                {%- form 'localization', id: 'HeaderLanguageForm', class: 'localization-form' -%}
                    <div>
                        <h2 class="visually-hidden" id="HeaderLanguageLabel">{{ 'localization.language_label' | t }}</h2>
                        {%- render 'language-localization', localPosition: 'HeaderLanguage' -%}
                    </div>
                {%- endform -%}
            </localization-form>
        {%- endif -%}
    </div>
{%- endif -%}

{%- if enable_search -%}
    {% render 'header-search', input_id: 'Search-In-Modal' %}
{%- endif -%}

{%- if enable_account and shop.customer_accounts_enabled -%}
    <a href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}" class="header__icon header__icon--account link focus-inset">
        {%- if block.settings.enable_customer_avatar -%}
            <account-icon>
                {%- if customer and customer.has_avatar? -%}
                    {{ customer | avatar }}
                {%- else -%}
                    <span class="svg-wrapper">
                        {{- 'icon-account.svg' | inline_asset_content -}}
                    </span>
                {%- endif -%}
            </account-icon>
        {%- else -%}
            <span class="svg-wrapper">
                {{- 'icon-account.svg' | inline_asset_content -}}
            </span>
        {%- endif -%}
        <span class="visually-hidden">
            {%- liquid
                if customer
                    echo 'customer.account_fallback' | t
                else
                    echo 'customer.log_in' | t
                endif
            -%}
        </span>
    </a>
{%- endif -%}

{%- if enable_cart -%}
    {%- if request.page_type != 'cart' and settings.cart_type == 'drawer' -%}
        <side-drawer-opener
            class="header__icon header__icon--cart link no-js-hidden"
            data-side-drawer="#Cart-Drawer"
        >
            <button class="t-button bor-none c-pointer pad-0 color-foreground bg-transparent focus-inset cart-icon--drawer"
                type="button"
                aria-haspopup="dialog"
                aria-label="{{ 'sections.header.cart_count' | t: count: cart.item_count }}"
                id="cart-icon-bubble"
            >
                {% if cart == empty %}
                    <span class="svg-wrapper">{{'icon-cart-empty.svg' | inline_asset_content }}</span>
                {% else %}
                    <span class="svg-wrapper">{{'icon-cart.svg' | inline_asset_content }}</span>
                {% endif %}
                <span class="visually-hidden">{{ 'templates.cart.cart' | t }}</span>
                {%- if cart != empty -%}
                    <div class="cart-count-bubble">
                        <span aria-hidden="true">
                            {%- if cart.item_count < 100 -%}
                                {{ cart.item_count }}
                            {%- else -%}
                                {{ 'sections.header.cart_count_max.more' | t }}
                            {%- endif -%}
                        </span>
                        <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
                    </div>
                {%- endif -%}
            </button>
        </side-drawer-opener>
        <noscript>
            <a href="{{ routes.cart_url }}" class="header__icon header__icon--cart link focus-inset cart-icon--drawer">
                {% if cart == empty %}
                    <span class="svg-wrapper">{{'icon-cart-empty.svg' | inline_asset_content }}</span>
                {% else %}
                    <span class="svg-wrapper">{{'icon-cart.svg' | inline_asset_content }}</span>
                {% endif %}
                <span class="visually-hidden">{{ 'templates.cart.cart' | t }}</span>
                {%- if cart != empty -%}
                    <div class="cart-count-bubble">
                        <span aria-hidden="true">
                            {%- if cart.item_count < 100 -%}
                                {{ cart.item_count }}
                            {%- else -%}
                                {{ 'sections.header.cart_count_max.more' | t }}
                            {%- endif -%}
                        </span>
                        <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
                    </div>
                {%- endif -%}
            </a>
        </noscript>
    {%- else -%}
        <a href="{{ routes.cart_url }}" class="header__icon header__icon--cart link focus-inset cart-icon--drawer" id="cart-icon-bubble">
            {% if cart == empty %}
                <span class="svg-wrapper">{{'icon-cart-empty.svg' | inline_asset_content }}</span>
            {% else %}
                <span class="svg-wrapper">{{'icon-cart.svg' | inline_asset_content }}</span>
            {% endif %}
            <span class="visually-hidden">{{ 'templates.cart.cart' | t }}</span>
            {%- if cart != empty -%}
                <div class="cart-count-bubble">
                    <span aria-hidden="true">
                        {%- if cart.item_count < 100 -%}
                            {{ cart.item_count }}
                        {%- else -%}
                            {{ 'sections.header.cart_count_max.more' | t }}
                        {%- endif -%}
                    </span>
                    <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
                </div>
            {%- endif -%}
        </a>
    {%- endif -%}
{%- endif -%}
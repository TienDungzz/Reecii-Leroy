{% comment %}
  Renders a full bleed overay
  @param {object} settings - Block or Section settings, expects `overlay_color`, `overlay_style`, `gradient_direction`
  @param {string} layer - The z-index layer to place the overlay on, defaults to var(--layer-flat)
{% endcomment %}
{%- liquid
  assign extend_left = settings.extend_left_overlay | default: false
  assign extend_right = settings.extend_right_overlay | default: false
-%}
<div
  class="overlay overlay--{{ settings.overlay_style | default: 'gradient' }}{% if extend_left %} overlay--extend-left{% endif %}{% if extend_right %} overlay--extend-right{% endif %}"
  style="
    --overlay-layer: {{ layer | default: 'var(--layer-flat)' }};
    --overlay-color: {{ settings.overlay_color | default: 'rgb(0 0 0 / var(--opacity-25))' }};
    --overlay-color--end: {{ settings.overlay_color | color_modify: 'alpha', 0 | default: 'rgb(0 0 0 / var(--opacity-0))' }};
    --overlay-direction: {{ settings.gradient_direction | default: 'to top' }};
    {%- if settings.border_radius %} --overlay-border-radius: {{ settings.border_radius | default: '0' }}px;{% endif -%}
  "
>
  <span class="visually-hidden"></span>
</div>

{% stylesheet %}
  .overlay {
    position: absolute;
    inset: 0;
    z-index: var(--overlay-layer);
    pointer-events: none;
    border-radius: var(--overlay-border-radius, 0px);
  }

  .overlay--solid {
    background: var(--overlay-color);
  }

  .overlay--gradient {
    background: linear-gradient(var(--overlay-direction), var(--overlay-color), var(--overlay-color--end));
  }

  @media screen and (min-width: 750px) {
    .overlay--extend-left::before,
    .overlay--extend-right::after {
      --width-extend: 7rem;
      content: '';
      position: absolute;
      inset: 0;
      z-index: var(--layer-section-background);
      pointer-events: none;
      border-radius: var(--overlay-border-radius, 0px);
      background: var(--overlay-color);
      width: var(--width-extend);
      height: 100%;
    }

    .overlay--extend-left::before {
      left: calc(var(--width-extend) * -1);
    }

    .overlay--extend-right::after {
      right: calc(var(--width-extend) * -1);
      left: auto;
    }

    *:has(+ .group-block .overlay--extend-left),
    .group-block:has(.overlay--extend-left):has(+ *) {
      z-index: var(--layer-flat);
    }
  }
{% endstylesheet %}

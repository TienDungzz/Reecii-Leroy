{{ 'customer.css' | asset_url | stylesheet_tag: preload: true }}

{%- if section.settings.enable_shop_login_button == false -%}
  {%- assign hide_shop_login_button = true -%}
{%- endif -%}

<div
  class="section customer login spacing"
  style="
    --p-spacing-t: {{ section.settings.padding_top }}px;
    --p-spacing-b: {{ section.settings.padding_bottom }}px;
  "
>
  <h2 id="recover" tabindex="-1">
    {{ 'customer.recover_password.title' | t }}
  </h2>
  <div>
    <p>
      {{ 'customer.recover_password.subtext' | t }}
    </p>

    {%- form 'recover_customer_password' -%}
      {% assign recover_success = form.posted_successfully? %}
      <div class="field">
        <input
          type="email"
          value=""
          name="email"
          id="RecoverEmail"
          autocorrect="off"
          autocapitalize="off"
          autocomplete="email"
          {% if form.errors %}
            aria-invalid="true"
            aria-describedby="RecoverEmail-email-error"
            autofocus
          {% endif %}
          placeholder="{{ 'customer.login_page.email' | t }}"
        >
        <label for="RecoverEmail">
          {{ 'customer.login_page.email' | t }}
        </label>
      </div>
      {%- if form.errors -%}
        <small id="RecoverEmail-email-error" class="form__message">
          <span class="svg-wrapper">
            {{- 'icon-error.svg' | inline_asset_content -}}
          </span>
          {{ form.errors.messages.form }}
        </small>
      {%- endif -%}

      <button>
        {{ 'customer.login_page.submit' | t }}
      </button>

      <a href="#login">
        {{ 'customer.login_page.cancel' | t }}
      </a>
    {%- endform -%}
  </div>

  <div>
    <div class="flex max-sm:flex-wrap">
      <div class="login-row--item login-row--item-left">
        <h2 id="login" tabindex="-1" class="login-title body-l-font-size">
          {{ 'customer.login_page.title' | t }}
        </h2>
        <div class="login-text">
          {{ 'customer.recover_password.subtext' | t }}
        </div>
        {%- if recover_success == true -%}
          <h3 class="form__message" tabindex="-1" autofocus>
            <span class="svg-wrapper">
              {{- 'icon-success.svg' | inline_asset_content -}}
            </span>
            {{ 'customer.recover_password.success' | t }}
          </h3>
        {%- endif -%}
        {%- form 'customer_login', novalidate: 'novalidate' -%}
          {%- if form.errors -%}
            <h2 class="form__message" tabindex="-1" autofocus>
              <span class="visually-hidden">{{ 'accessibility.error' | t }} </span>
              <span class="svg-wrapper">
                {{- 'icon-error.svg' | inline_asset_content -}}
              </span>
              {{ 'content.form.error_heading' | t }}
            </h2>
            {{ form.errors | default_errors }}
          {%- endif -%}

          {%- if shop.features.login_with_shop_classic_customer_accounts? -%}
            <section name="sign-in-with-shop-provider">
              {{ shop | login_button: hide_button: hide_shop_login_button }}

              {%- unless hide_shop_login_button -%}
                <p>
                  {{ 'customer.login_page.alternate_provider_separator' | t }}
                </p>
              {%- endunless -%}
            </section>
          {%- endif -%}

          <div class="field">
            <label for="CustomerEmail">
              {{ 'customer.login_page.email' | t }}
            </label>
            <input
              type="email"
              name="customer[email]"
              id="CustomerEmail"
              autocomplete="email"
              autocorrect="off"
              autocapitalize="off"
              {% if form.errors contains 'form' %}
                aria-invalid="true"
              {% endif %}
              placeholder="{{ 'customer.login_page.email' | t }}"
            >
          </div>

          {%- if form.password_needed -%}
            <div class="field">
              <label for="CustomerPassword">
                {{ 'customer.login_page.password' | t }}
              </label>
              <input
                type="password"
                value=""
                name="customer[password]"
                id="CustomerPassword"
                autocomplete="current-password"
                {% if form.errors contains 'form' %}
                  aria-invalid="true"
                {% endif %}
                placeholder="{{ 'customer.login_page.password' | t }}"
              >
            </div>
          {%- endif -%}
          <div class="flex items-center gap-4xl" style="--mt: var(--margin-xl)">
            <button class="button button--primary">
              {{ 'customer.login_page.title' | t }}
            </button>

            {% comment %}
              <a href="{{ routes.account_register_url }}">
                {{ 'customer.login_page.create_account' | t }}
              </a>
            {% endcomment %}

            <a href="#recover">
              {{ 'customer.login_page.forgot_password' | t }}
            </a>
          </div>
        {%- endform -%}
      </div>
      <div class="login-row--item login-row--item-right">
        <div class="login-item">
          <h2 class="login-title body-l-font-size">
            {{ 'customer.register.title' | t }}
          </h2>
          <div class="page-wrapper">
            <div class="login-text">
              {{ 'customer.register.text' | t }}
            </div>
            {%- form 'create_customer', class: 'create-customer-form' -%}
              {%- if form.errors -%}
                <div class="form-message" role="alert">
                  <div class="alertBox alertBox--error">
                    <div class="alertBox-message">
                      <ul>
                        {%- for field in form.errors -%}
                          <li>
                            {%- if field == 'form' -%}
                              {{ form.errors.messages[field] }}
                            {%- else -%}
                              <a href="#RegisterForm-{{ field }}" class="link link-underline">
                                <span class="text">
                                  {{ form.errors.translated_fields[field] | capitalize }}
                                  {{ form.errors.messages[field] }}
                                </span>
                              </a>
                            {%- endif -%}
                          </li>
                        {%- endfor -%}
                      </ul>
                    </div>
                  </div>
                </div>
              {% endif %}
              <div class="field{% if form.errors contains "first_name" %} field--error{% endif %}">
                <label class="form-label" for="RegisterForm-FirstName">
                  {{ 'customer.register.first_name' | t }}
                </label>
                <input
                  class="form-input form-input-placeholder{% if form.errors contains "first_name" %} error{% endif %}"
                  type="text"
                  name="customer[first_name]"
                  id="RegisterForm-FirstName"
                  {% if form.first_name %}
                    value="{{ form.first_name }}"
                  {% endif %}
                  autocomplete="given-name"
                  placeholder=""
                >
              </div>
              <div class="field{% if form.errors contains "last_name" %} field--error{% endif %}">
                <label class="form-label" for="RegisterForm-LastName">
                  {{ 'customer.register.last_name' | t }}
                </label>
                <input
                  class="form-input form-input-placeholder{% if form.errors contains "last_name" %} error{% endif %}"
                  type="text"
                  name="customer[last_name]"
                  id="RegisterForm-LastName"
                  {% if form.last_name %}
                    value="{{ form.last_name }}"
                  {% endif %}
                  autocomplete="family-name"
                  placeholder=""
                >
              </div>
              <div class="field{% if form.errors contains "email" %} field--error{% endif %}">
                <label class="form-label" for="RegisterForm-email">
                  {{ 'customer.register.email' | t }}
                  <em>*</em>
                </label>
                <input
                  class="form-input form-input-placeholder{% if form.errors contains "email" %} error{% endif %}"
                  type="email"
                  name="customer[email]"
                  id="RegisterForm-email"
                  {% if form.email %}
                    value="{{ form.email }}"
                  {% endif %}
                  spellcheck="false"
                  autocapitalize="off"
                  autocomplete="email"
                  aria-required="true"
                  {% if form.errors contains 'email' %}
                    aria-invalid="true"
                    aria-describedby="RegisterForm-email-error"
                  {% endif %}
                  placeholder=""
                  required
                >
              </div>
              <div class="field{% if form.errors contains "password" %} field--error{% endif %}">
                <label class="form-label" for="password">
                  {{ 'customer.register.password' | t }}
                  <em>*</em>
                </label>
                <input
                  class="form-input form-input-placeholder{% if form.errors contains "password" %} error{% endif %}"
                  type="password"
                  name="customer[password]"
                  id="RegisterForm-password"
                  aria-required="true"
                  {% if form.errors contains 'password' %}
                    aria-invalid="true"
                    aria-describedby="RegisterForm-password-error"
                  {% endif %}
                  placeholder=""
                  required
                >
              </div>
              <div class="form-actions" style="--mt: var(--margin-xl)">
                {% if settings.enable_button_1_border_outside %}
                  <button class="button button--secondary">
                    <span>{{ 'customer.register.create_an_account' | t }}</span>
                  </button>
                {% else %}
                  <input type="submit" value="{{ 'customer.register.create_an_account' | t }}" class="button button--secondary">
                {% endif %}
              </div>
            {%- endform -%}
          </div>
        </div>
      </div>
    </div>
  </div>

  {%- if shop.checkout.guest_login -%}
    <div>
      <hr>
      <h2>{{ 'customer.login_page.guest_title' | t }}</h2>

      {%- form 'guest_login' -%}
        <button>
          {{ 'customer.login_page.guest_continue' | t }}
        </button>
      {%- endform -%}
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "t:names.login",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_shop_login_button",
      "label": "t:settings.enable_sign_in_with_shop_button",  
      "default": true
    },
    {
      "type": "header",
      "content": "t:content.section_padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "t:settings.top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "t:settings.bottom",
      "default": 36
    }
  ]
}
{% endschema %}
